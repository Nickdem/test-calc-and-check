"use strict";var baseData=JSON.parse(localStorage.getItem("checkboxes")),checkboxes=(window.addEventListener("DOMContentLoaded",function(){var t=document.querySelector(".switch input"),e=document.querySelector(".progress");baseData||toLocalStorage(baseData=mockData),checkboxes(),t.addEventListener("change",function(){t.checked?(editor(),e.style.display="none"):(checkboxes(),e.style.display="block")})}),function(){makeCheckboxList(baseData),progressBar()}),makeCheckboxList=function(t){var e=document.querySelector(".checkboxes__list");e.innerHTML="",t.forEach(function(t){e.append(makeListItem(t))})},makeListItem=function(a){var s,t,n,e=document.createElement("li"),i=document.createElement("div"),m=document.createElement("input"),o=(m.setAttribute("type","checkbox"),m.setAttribute("id",a.itemId),m.setAttribute("name",a.itemId),m.checked=a.status,document.createElement("label"));return o.setAttribute("for",a.itemId),o.textContent=a.itemName,i.append(m,o),e.append(i),a.itemNew&&((o=document.createElement("span")).classList.add("new"),o.textContent="new",e.append(o)),a.itemList&&(e.classList.add("checkboxes__item","item"),(s=document.createElement("ul")).classList.add("checkboxes__sublist","checkboxes__sublist--hide"),(t=document.createElement("button")).textContent="Раскрыть",t.classList.add("item__transparent"),t.addEventListener("click",function(){t.innerText="Раскрыть"==t.innerText?"Скрыть":"Раскрыть",s.classList.toggle("checkboxes__sublist--hide")}),i.append(t),a.itemList.forEach(function(t){s.append(makeListItem(t))}),n=s.querySelectorAll('[type="checkbox"]'),m.addEventListener("change",function(){a.status=m.checked,n.forEach(function(t,e){a.itemList[e].status=m.checked,t.checked=m.checked}),progressBar()}),n.forEach(function(e,i){e.addEventListener("change",function(){var t=s.querySelectorAll("input:checked");a.itemList[i].status=e.checked,n.length==t.length?m.checked=!0:m.checked=!1,a.status=m.checked,progressBar()})}),e.append(s)),a.itemList||(e.classList.add("checkboxes__subitem"),(o=document.createElement("a")).textContent="Прочитать инструкцию",o.setAttribute("href",a.itemLink),o.setAttribute("target","_blank"),i.append(o)),e},editor=function(){makeEditorItems(baseData)},makeEditorItems=function(t){var e=document.querySelector(".checkboxes__list"),t=(e.innerHTML="",t.forEach(function(t){e.append(makeEditorForm(t))}),document.createElement("button"));t.classList.add("btn__create"),t.textContent="Создать новый элемент",t.addEventListener("click",function(){baseData.push(baseEl()),toLocalStorage(baseData),editor()}),e.append(t)},makeEditorForm=function(a){var e,t,s=document.createElement("li"),i=document.createElement("div"),n=document.createElement("input"),m=(n.setAttribute("type","text"),n.setAttribute("id",a.itemId),n.setAttribute("name",a.itemId),n.value=a.itemName,document.createElement("label")),o=(m.setAttribute("for",a.itemId),m.textContent="Название:",document.createElement("button")),c=(o.textContent="Сохранить",o.classList.add("item__transparent"),o.disabled=!0,o.style.opacity="0",document.createElement("button"));return c.classList.add("button"),c.textContent="Удалить",i.append(m,n),s.append(i),a.itemList&&(s.classList.add("checkboxes__item","item"),(e=document.createElement("ul")).classList.add("checkboxes__sublist"),n.addEventListener("change",function(){o.disabled=!1,o.style.opacity="1"}),a.itemList.forEach(function(t){e.append(makeEditorForm(t))}),o.addEventListener("click",function(){a.itemName=n.value,toLocalStorage(baseData),o.disabled=!0,o.style.opacity="0"}),c.addEventListener("click",function(){confirm("Вы уверены?")&&(s.remove(),baseData=baseData.filter(function(t){return t.itemId!==a.itemId}),toLocalStorage(baseData))}),s.append(e),(m=document.createElement("button")).classList.add("btn__create"),m.textContent="Создать новый сабэлемент",m.addEventListener("click",function(){a.itemList.push(baseSubEl()),toLocalStorage(baseData),editor()}),s.append(m)),a.itemList||(s.classList.add("checkboxes__subitem"),(t=document.createElement("input")).setAttribute("type","text"),t.setAttribute("id","link-"+a.itemId),t.setAttribute("name","link-"+a.itemId),t.value=a.itemLink,(m=document.createElement("label")).setAttribute("for","link-"+a.itemId),m.textContent="Ссылка:",i.append(m,t),n.addEventListener("change",function(){o.disabled=!1,o.style.opacity="1"}),t.addEventListener("change",function(){o.disabled=!1,o.style.opacity="1"}),o.addEventListener("click",function(){a.itemName=n.value,a.itemLink=t.value,toLocalStorage(baseData),o.disabled=!0,o.style.opacity="0"}),c.addEventListener("click",function(){if(confirm("Вы уверены?")){s.remove();for(var t=0,e=baseData;t<e.length;t++){var i=e[t];i.itemList=i.itemList.filter(function(t){return t.itemId!==a.itemId})}toLocalStorage(baseData)}})),i.append(o,c),s},progressBar=function(){var t=document.querySelector(".progress__fill"),e=document.querySelector(".progress__value"),i=document.querySelectorAll('.checkboxes__sublist [type="checkbox"]'),i=document.querySelectorAll('.checkboxes__sublist [type="checkbox"]:checked').length/i.length*100;e.textContent=Math.round(i).toString(),t.style.width=i.toString()+"%"},toLocalStorage=function(t){localStorage.setItem("checkboxes",JSON.stringify(t))},timeString=function(){return Date.now().toString()},baseSubEl=function(){return{itemName:"Базовое значение",itemId:"idSub"+timeString(),status:!1,itemLink:"https://www.google.com/",itemNew:!0}},baseEl=function(){return{itemName:"Базовое значение",itemId:"id"+timeString(),status:!1,itemList:[baseSubEl()],itemNew:!0}},mockData=[{itemName:"Подготовительные работы",itemId:"jobs",status:!1,itemList:[{itemName:"Подготовительные работы 1",itemId:"jobs-1",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"Подготовительные работы 2",itemId:"jobs-2",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"Подготовительные работы 3",itemId:"jobs-3",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"Подготовительные работы 4",itemId:"jobs-4",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"Подготовительные работы 5",itemId:"jobs-5",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"Подготовительные работы 6",itemId:"jobs-6",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"Подготовительные работы 7",itemId:"jobs-7",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"Подготовительные работы 8",itemId:"jobs-8",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"Подготовительные работы 9",itemId:"jobs-9",status:!1,itemLink:"https://ru.wikipedia.org/",itemNew:!0},{itemName:"Подготовительные работы 10",itemId:"jobs-10",status:!1,itemLink:"https://ru.wikipedia.org/",itemNew:!0}]},{itemName:"SEO-аналитика",itemId:"seo",status:!1,itemList:[{itemName:"SEO-аналитика 1",itemId:"seo-1",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"SEO-аналитика 2",itemId:"seo-2",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"SEO-аналитика 3",itemId:"seo-3",status:!1,itemLink:"https://ru.wikipedia.org/",itemNew:!0},{itemName:"SEO-аналитика 4",itemId:"seo-4",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"SEO-аналитика 5",itemId:"seo-5",status:!1,itemLink:"https://ru.wikipedia.org/",itemNew:!0}]},{itemName:"Стратегия продвижения",itemId:"strategy",status:!1,itemList:[{itemName:"Стратегия продвижения 1",itemId:"strategy-1",status:!1,itemLink:"https://ru.wikipedia.org/",itemNew:!0},{itemName:"Стратегия продвижения 2",itemId:"strategy-2",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"Стратегия продвижения 3",itemId:"strategy-3",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"Стратегия продвижения 4",itemId:"strategy-4",status:!1,itemLink:"https://ru.wikipedia.org/"},{itemName:"Стратегия продвижения 5",itemId:"strategy-5",status:!1,itemLink:"https://ru.wikipedia.org/"}]}];
//# sourceMappingURL=checkboxes.min.js.map
